#!/bin/bash

set -e

export XDG_CONFIG_HOME=$HOME/.config 

### zim (zsh config manager)
# https://github.com/zimfw/zimfw
zsh $XDG_CONFIG_HOME/zsh/zim/zimfw.zsh upgrade
zsh $XDG_CONFIG_HOME/zsh/zim/zimfw.zsh install
zsh $XDG_CONFIG_HOME/zsh/zim/zimfw.zsh update

### Setup fzf (fuzzy finder)
# https://github.com/junegunn/fzf
FZFDIR=$XDG_CONFIG_HOME/fzf
git clone --depth 1 "https://github.com/junegunn/fzf.git" "$FZFDIR" 2> /dev/null || (cd "$FZFDIR" ; git pull)
$FZFDIR/install --xdg --completion --key-bindings --update-rc

curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" # This loads nvm
nvm install node 
npm install -g yarn

PACKAGER_DIR="$XDG_CONFIG_HOME/nvim/pack/packager/opt/vim-packager"

if ! [ -e "$PACKAGER_DIR" ]; then
  echo "Begin fetching vim-packager..."
  mkdir -p "$PACKAGER_DIR"
  git clone https://github.com/kristijanhusak/vim-packager "$PACKAGER_DIR"
fi
nvim '+:PackagerInstall'
echo "Installed und updated vim-packager and all vim plugins."
